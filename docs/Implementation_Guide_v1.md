# StockAI Trader v1.0 实施指南

## 数据源选择

- 优先选择免费的数据源。例如：  
  - 日线行情和基本财务数据：可使用 yfinance 或 AKShare 等免费 API。  
  - 实时或分钟级行情：优先选择提供免费套餐的服务商（如 Twelve Data 的免费版、IEX Cloud 免费额度），必要时再考虑付费方案。  
- 为每个数据源建立缓存策略：昨日及更早的数据缓存在本地（Parquet/SQLite），当日数据采用内存缓存并设置 TTL，减少重复请求和加快分析速度。  
- 当用户在盘中请求分析时，先检查缓存数据的新鲜度；如果缓存落后于当前时间，只抓取缺失的最新 K 线或资金数据并更新缓存，然后再进行指标计算。

## 技术分析策略

- 不使用单一固定阈值（如 RSI > 70 定义超买），而是结合趋势、动量、回调等多种信号进行综合评分。  
- 主要信号包括：  
  - **趋势类**：短期、中期、长期均线（如 EMA20、EMA50、EMA200）的排列关系；ADX 强弱；Anchored VWAP；  
  - **动量类**：MACD 金叉/死叉、RSI 分位、StochRSI 等；  
  - **回调/反转类**：KDJ 的 J 值、布林带位置、价格回踩重要支撑位等。  
- 给每类信号赋予权重（比如趋势 0.5、动量 0.3、回调/反转 0.2），对所有信号打分求和，得到综合评分并转换为买入、卖出或观望决策。  
- 通过均线、前高/前低、ATR 等确定买入价、止损价和目标价区间，确保决策有据可依。

## 技术栈与模块划分

- **数据层与分析层**：使用 Python。  
  - Python 拥有成熟的科学计算生态（pandas、numpy、ta‑lib、pandas_ta），适合处理行情数据和计算技术指标。  
  - 在 `datahub` 模块中封装数据抓取、缓存和指标计算，使用异步方式批量拉取数据。  
  - 在 `engine` 模块中实现信号打分、规则组合以及生成结构化的分析结果。  
- **应用层/API 网关**：使用 FastAPI。  
  - FastAPI 简洁高效，便于快速暴露分析接口。  
  - 提供如 `POST /analyze` 的端点，接受股票代码和时间粒度，返回结构化的分析报告。  
- **前端**：使用 Vue3 + TypeScript。  
  - 创建一个简单的 Web 界面，输入股票代码即可调用后端分析接口并展示结果。  
  - 首屏显示关键结论（操作建议、买入/止损/目标价区间、置信度），同时可展开查看详细指标及理由。  
- 将来可扩展：Node.js 作为网关或消息队列来处理并发请求；但 v1.0 MVP 阶段优先实现核心功能。

## 实施步骤概要

1. **搭建项目结构**：按照 `datahub/`、`engine/`、`api.py`、`frontend/` 等目录划分基础文件。  
2. **实现数据抓取与缓存**：  
   - 集成 yfinance 或 AKShare 获取日 K 线和必要的财务数据；  
   - 配置一个支持分钟级数据的免费源用于盘中更新；  
   - 构建缓存管理模块，支持按日期和时间刷新。  
3. **完成指标计算模块**：用 pandas‑ta 或 ta‑lib 计算 MACD、RSI、KDJ、布林带、均线、ADX、ATR 等指标。  
4. **开发规则引擎**：设计信号打分函数，将多类指标组合成综合评分，并输出买入/卖出/观望的初步结论。  
5. **生成报告**：根据综合评分和买卖区间，用模板生成简洁的中文分析报告，并在 API 接口中返回。  
6. **搭建 FastAPI 服务**：实现 `/analyze` 接口，串联数据抓取、指标计算、规则引擎和报告生成。  
7. **开发 Vue3 前端**：创建简单界面，发送请求到 FastAPI，展示报告结果。  
8. **测试与优化**：  
   - 在多只热门股票上测试分析结果和性能，确保总耗时 ≤ 60 秒；  
   - 调整缓存策略和信号权重，提高结论稳定性和准确性；  
   - 根据用户反馈迭代功能。

该文档汇总了 v1.0 MVP 的核心实施思路，可作为你开发时的指南.
